<template>
  <section class="p-4 rounded-b-2xl bg-white">
    <div class="py-0.5 space-y-2">
      <h1 class="font-bold">{{ info.stitle }}</h1>
      <p class="text-red-400 font-semibold text-2xl">
        {{ info.iprice }}<span class="text-sm ml-1">港币 (约{{ priceHk }}元)</span>
      </p>
      <div class="flex justify-between text-gray-600 text-sm">
        <p>{{ info.brand }}</p>
        <p class="flex-shrink-0 ml-2">已售{{ info.icountsale }}件</p>
      </div>
      <div class="w-full text-sm flex items-center justify-between px-1 pt-3">
        <!-- 正品承诺 -->
        <div>
          <svg class="icon inline-block" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M742.912 722.08c3.84-3.136 8.064-5.76 11.776-9.056 7.424-6.624 11.36-16.352 10.688-26.272l-3.68-50.976L812.224 628c9.92-1.536 18.56-7.616 23.296-16.448 29.184-53.984 44.544-115.104 44.544-176.8 0-4.16-.256-8.256-.544-12.32l-.32-4.768a32.023 32.023 0 00-13.792-24.8l-42.144-29.12 25.984-45.472a32.156 32.156 0 001.696-28.256c-25.984-61.504-68.416-115.072-122.848-154.976-8.16-5.984-18.656-7.744-28.352-4.768l-49.024 15.136-19.04-48.448a31.91 31.91 0 00-21.152-19.136c-65.504-18.336-131.52-18.336-196.992 0a31.892 31.892 0 00-21.184 19.136l-18.976 48.448-49.056-15.136a32.03 32.03 0 00-28.352 4.768c-54.464 39.872-96.928 93.472-122.816 154.944-3.872 9.184-3.264 19.648 1.664 28.288l25.92 45.472-42.144 29.12A31.982 31.982 0 00144.8 417.76l-.288 4.96c-.256 4-.512 7.968-.512 12.032 0 61.728 15.392 122.88 44.512 176.8 4.768 8.864 13.376 14.912 23.296 16.448l50.528 7.776-3.712 50.976c-.736 9.952 3.232 19.648 10.688 26.272 3.552 3.168 7.584 5.664 11.264 8.672l-85.824 140.448c-7.712 12.672-7.2 28.128 1.344 39.36 8.544 11.2 23.328 15.808 37.472 11.776l79.616-22.336 49.408 57.024c7.136 8.192 16.864 12.672 27.008 12.672 2.432 0 4.896-.288 7.424-.8 12.672-2.72 22.56-12.064 26.464-25.024l40.928-136.896c3.904-1.472 7.616-3.552 10.752-6.496L512 757.088l36.8 34.272c6.016 5.6 13.824 8.64 21.856 8.64 1.92 0 3.712-.16 5.6-.512 40.16-7.136 78.272-21.696 113.696-41.504L736 831.136l-19.712-5.536c-15.392-4.416-32.768.736-43.328 12.8l-27.296 31.328-4.896-13.6c-5.952-16.672-24.256-25.408-40.896-19.296-16.672 5.984-25.28 24.32-19.296 40.928l21.12 58.752c4.448 12.32 14.496 21.12 27.008 23.456 2.112.416 4.352.608 6.496.608 10.176 0 20-4.512 27.072-12.672l49.856-57.088 80.224 22.368c14.496 4.032 29.248-.672 37.76-11.968 8.512-11.36 8.832-26.912.832-39.552L742.912 722.08zm-365.92 144.704l-24.576-28.352c-10.496-12.096-27.968-17.28-43.168-12.896l-20.672 5.824 44.992-73.664c21.408 12.032 43.648 22.528 67.04 30.016l-23.616 79.072zm156.832-176.8c-12.288-11.424-31.328-11.424-43.616 0l-46.592 43.328c-43.712-10.144-84.672-30.016-120-58.208l4.64-64.16c1.216-16.64-10.56-31.392-27.04-33.952l-63.456-9.728c-19.264-40.608-29.504-85.408-29.76-130.72l53.28-36.768c13.632-9.44 17.824-27.744 9.6-42.176l-32.384-56.864c19.456-40.224 47.712-75.904 82.784-104.416l61.6 19.008c16.096 5.024 33.12-3.328 39.264-18.912l23.84-60.832c44.192-10.08 87.84-10.08 132.064 0l23.872 60.832c6.08 15.584 23.168 23.872 39.2 18.912l61.6-19.008c35.104 28.512 63.328 64.192 222.784 104.416l-32.416 56.832c-8.224 14.432-4.032 32.768 9.632 42.176L816 436.512c-.256 45.28-10.496 90.112-29.76 130.72l-63.456 9.792c-16.48 2.528-28.256 17.312-27.04 33.952l4.64 64.16c-35.296 28.192-76.288 48.064-119.936 58.208l-46.624-43.36z" fill="#f23030" /><path d="M512 654.016c-122.4 0-222.016-99.552-222.016-222.016S389.6 209.984 512 209.984 734.016 309.568 734.016 432 634.4 654.016 512 654.016zm0-380.032c-87.136 0-158.016 70.88-158.016 158.016S424.864 590.016 512 590.016 670.016 519.168 670.016 432 599.136 273.984 512 273.984z" fill="#f23030" /></svg>
          <span class="ml-2">正品承诺</span>
        </div>
        <div class="w-px h-5 bg-gray-300" />
        <!-- 海外直邮 -->
        <div>
          <svg class="icon inline-block" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M960 512c0-246.4-201.6-448-448-448-80 0-156.8 22.4-220.8 57.6-48 25.6-86.4 60.8-112 92.8A441.6 441.6 0 0064 512c0 246.4 201.6 448 448 448 19.2 0 38.4-3.2 57.6-3.2h6.4c67.2-3.2 118.4-28.8 160-57.6C870.4 822.4 960 678.4 960 512zm-64 0c0 92.8-32 179.2-89.6 246.4-28.8-16-115.2-54.4-131.2-64-16-6.4-41.6-3.2-70.4 12.8-3.2-3.2-3.2-6.4-6.4-9.6L492.8 595.2c0-9.6 0-22.4 6.4-25.6 9.6 0 35.2 19.2 51.2 41.6 6.4 9.6 19.2 12.8 28.8 9.6 12.8-3.2 19.2-9.6 25.6-19.2 3.2-6.4 25.6-76.8-9.6-115.2l-3.2-3.2c3.2-16 60.8-48 89.6-64 54.4-32 99.2-57.6 105.6-96 3.2-16 6.4-38.4-105.6-118.4-12.8-9.6-32-6.4-41.6 3.2l-73.6 80-48-32 64-35.2c12.8-6.4 19.2-19.2 16-32-3.2-12.8-12.8-22.4-25.6-25.6l-118.4-25.6c16-6.4 38.4-9.6 57.6-9.6 211.2 0 384 172.8 384 384zM627.2 876.8c9.6-41.6 6.4-83.2 0-108.8 9.6-6.4 22.4-12.8 28.8-12.8 16 6.4 60.8 28.8 96 44.8-12.8 16-32 32-57.6 48-22.4 12.8-44.8 22.4-67.2 28.8zM432 611.2c-6.4-9.6-9.6-16-16-25.6-44.8-70.4-76.8-115.2-112-121.6h-9.6c-9.6 0-16 3.2-25.6 6.4-19.2-19.2-48-96-67.2-179.2 6.4-9.6 19.2-28.8 35.2-48l3.2-3.2c0-3.2 3.2-3.2 6.4-6.4 19.2-16 41.6-35.2 67.2-51.2 16-9.6 35.2-16 54.4-22.4l54.4 32c3.2 0 6.4 3.2 9.6 3.2l44.8 9.6-35.2 19.2c-9.6 6.4-16 16-16 25.6s6.4 22.4 12.8 28.8L553.6 352c12.8 9.6 28.8 6.4 41.6-6.4l73.6-76.8c22.4 16 41.6 35.2 51.2 44.8-12.8 12.8-48 32-70.4 44.8-57.6 32-112 64-118.4 112-3.2 12.8 0 28.8 9.6 44.8-22.4-12.8-48-19.2-70.4-3.2-38.4 25.6-41.6 70.4-38.4 99.2zM128 512c0-51.2 9.6-99.2 28.8-140.8 19.2 67.2 51.2 144 92.8 160 16 6.4 32 3.2 44.8-3.2 16 12.8 51.2 64 67.2 92.8 38.4 57.6 57.6 92.8 89.6 92.8 12.8 3.2 67.2 19.2 112 35.2v16s19.2 76.8-6.4 128c-16 3.2-28.8 3.2-44.8 3.2-211.2 0-384-172.8-384-384z" fill="#f23030" /></svg>
          <span class="ml-2">海外直邮</span>
        </div>
        <div class="w-px h-5 bg-gray-300" />
        <!-- 低价保障 -->
        <div>
          <svg class="icon inline-block" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M712.416 357.056L479.072 592.864 375.808 486.752c-12.384-12.704-32.608-12.928-45.248-.64-12.672 12.32-12.96 32.608-.64 45.248l126.016 129.504c.064.096.192.096.256.192.064.064.096.192.16.256 2.08 2.048 4.608 3.264 7.008 4.64 1.184.672 2.176 1.728 3.392 2.208 3.872 1.6 7.968 2.4 12.096 2.4 4.064 0 8.128-.8 11.968-2.336 1.248-.512 2.208-1.536 3.392-2.176 2.4-1.344 4.896-2.528 6.944-4.544.064-.064.096-.192.192-.256.064-.096.16-.128.256-.192l256.288-259.008c12.448-12.576 12.32-32.8-.256-45.248-12.512-12.416-32.832-12.32-45.216.256z" fill="#f23030" /><path d="M517.44 64.48c-3.552-.608-7.168-.64-10.72-.032-95.712 16.064-408 77.728-408 196.864 0 385.792 312.032 701.344 413.312 701.344 99.52 0 418.688-323.488 418.688-701.344-.032-113.376-289.024-175.424-413.28-196.832zM512 898.624c-58.784-5.632-349.312-281.184-349.312-637.312 0-38.464 165.792-101.344 349.248-132.832 186.336 32.768 354.752 95.68 354.752 132.832C866.688 616.736 571.68 892.8 512 898.624z" fill="#f23030" /></svg>
          <span class="ml-2">低价保障</span>
        </div>
      </div>
    </div>
  </section>
</template>

<script>
import api from '/src/api/index.js'
import { ref, watch } from 'vue'
import { useRoute, useRouter } from 'vue-router'
export default {
  emits:['getCount'],
  setup(props, { emit }) {
    const route = useRoute()
    const router = useRouter()
    const info = ref({})
    const priceHk = ref(0)
    const getInfo = function() {
      api.get("/open/product_detail/get_product_info", { id: route.params.id }).then((res) => {
        if(res.data.code === 20001 && res.data.msg === '药品不存在') { router.replace('/404'); return }
        info.value = res.data.data
        priceHk.value = Math.round(res.data.data.iprice * +sessionStorage.getItem('rate') * 10) / 10
        emit('getCount', res.data.data.icount, res.data.data.iscollect)
      })
    }
    getInfo()
    watch(() => route.params, async newParams => { if(newParams.id) getInfo() })
    return {
      info,
      priceHk
    }
  }
}
</script>